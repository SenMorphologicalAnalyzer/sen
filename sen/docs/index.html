<!-- dummy comment for Mac IE -->
<?xml version='1.0' encoding='UTF-8'?>

<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.1 Transitional//EN'
'http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='ja' lang='ja'>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<title>Sen</title>
<style>
.command {
  background-color: black;
  color: white;
}
.source {
  border-color: black;
  border-width: 1pt;
  border-style: solid;
  background-color: white;
}
</style>
<link rel=stylesheet href='/~tora/default.css' type='text/css' />
</head>

<body bgcolor="#ffe0c0">
<h1>Sen(Java 形態素解析エンジン)</h1>

<h2>Sen とは?</h2>
Sen は、Java で実装された形態素解析器で、<a href='http://cl.aist-nara.ac.jp/~taku-ku/'>工藤拓</a>さんによりオープンソース(LGPL)で開発され
ている形態素解析器mecabをJavaのポーティングしたものです。
Jakarta で開発されてる Java のインデックスサーチエンジン  <a href='http://jakarta.apache.org/lucene/'>Lucene </a> と組み合わせると、
日本語の全文検索を行うことができるようになります。SenはJ2SE/J2EEに対応していますので、Javaを利用したリッチクライアントから
J2EEアプリケーションまで、幅広くご利用頂けます。<br /><br />
<p />
<h2>応用例</h2>
Senの形態素解析機能を利用すると、次のようなソフトウェアを作成することができます。
<ul>
<li>全文検索エンジン</li>
<li>テキストマイニングツール</li>
<li>スパムフィルタ</li>
<li>日本語の教育ソフト</li>
<li>和英翻訳システム</li>
<li>人工知能及び人工無能</li>
</ul>

<h2>ライセンス</h2>
LGPL(Lesser General Public License)です。sen-0.43まではGPLでしたが、ユーザの利便性を考慮して0.44からLGPLへ変更しました。
Senをソフトウェアに組み込んで利用しても、ソースコードを公開する必要はありません。ただし、Sen自身に改変を加えた場合は、改変
を加えた部分を公開してください。

<h2>動作確認済環境</h2>
<ul>
  <li>Linux (Debian GNU/Linuxで動作確認を行っていますが、他のディストリビューションでも動くと思います)</li>
  <li>Windows XP</li>
</ul>
基本的に、Perl と Java が入っていれば、他の環境でも使えると思います。
Windows では、cygwin 等が必要かも知れません。

<h2>インストール</h2>
<h3>ダウンロード</h3>
<a href='https://sen.dev.java.net/servlets/ProjectDocumentList?folderID=755&expandFolder=755&folderID=0'>Java.NETのSenのプロジェクト</a>から、アーカイブsen-xxx.zipをダウンロード、適当なディレクトリに解凍します。

<a name="make_dic" id="make_dic"></a>
<h3>辞書作成</h3>
ダウンロードしたら、まず、辞書を作成します。辞書の作成には、次のソフトウェアが必要となります。
<ul>
  <li>perl5.6以降</li>
  <li>ant1.5以降</li>
</ul>
辞書を作成するには、dic ディレクトリに移動して、
<table><tr><td class=command><pre>
$ <b>ant</b>
</pre></td></tr></table>
とantを実行するだけです。antが自動的にIPADICの辞書ファイルをダウンロードし、Sen用の辞書を作成します。
<p>
Widowsで辞書を作成するには、プロパティperl.binに対して下記のようにperlの実行ファイルを絶対パスで指定します。
<table><tr><td class=command><pre>
C:\sen> <b>ant -Dperl.bin=C:\Perl\bin\perl.exe</b>
</pre></td></tr></table>
</p>

<h4>注意事項</h4>
Fire Wall 等があるため、プロキシの設定が必要な場合、次のようして、プロキシのホスト名とポート番号を指定して下さい。
<table><tr><td class=command><pre>
$ ant -Dproxy.host=proxy.hoehoe.jp -Dproxy.port=8080
</pre></td></tr></table>
Passive FTPを利用しなければならない環境では、ブラウザ等で<a href="http://chasen.aist-nara.ac.jp/stable/ipadic">NAIST<a>から、ipadic-2.6.0.tar.gz をダウンロードし、dic ディレクトリに置いてから、ant を実行して下さい。

<h3>サンプルプログラム実行</h3>
SEN_HOME環境変数をsenをインストールしたディレクトリに設定しbin ディレクトリでsen.shを実行するとデモが起動します。コンソールに文書を入力するように聞いてきますので、適当に文書を入力してみましょう。
<table><tr><td class=command><pre>
$ <b>export SEN_HOME=/usr/local/sen-1.0
$ <b>cd /usr/local/sen-1.0/bin</b>
$ <b>sh sen.sh</b>
now loading dictionary...
done.
Please input Japanese sentence:
<b>千と千尋の神隠しのＤＶＤが発売されましたが、プレステ２では、うまく色が出ないので買いませんでした</b>
千      (千)    名詞-数(0,1,1)  セン    セン
と      (と)    助詞-並立助詞(1,2,1)    ト      ト
千尋    (千尋)  名詞-一般(2,4,2)        {センジン/チヒロ}       {センジン/チヒロ}
の      (の)    助詞-連体化(4,5,1)      ノ      ノ
神隠し  (神隠し)        名詞-一般(5,8,3)        カミガクシ      カミガクシ
の      (の)    助詞-連体化(8,9,1)      ノ      ノ
ＤＶＤ  (ＤＶＤ)        未知語(9,12,3)  null    null
が      (が)    助詞-格助詞-一般(12,13,1)       ガ      ガ
発売    (発売)  名詞-サ変接続(13,15,2)  ハツバイ        ハツバイ
さ      (する)  動詞-自立(15,16,1)      サ      サ
れ      (れる)  動詞-接尾(16,17,1)      レ      レ
まし    (ます)  助動詞(17,19,2) マシ    マシ
た      (た)    助動詞(19,20,1) タ      タ
が      (が)    助詞-接続助詞(20,21,1)  ガ      ガ
、      (、)    記号-読点(21,22,1)      、      、
プレステ        (プレステ)      未知語(22,26,4) null    null
２      (２)    未知語(26,27,1) null    null
で      (で)    助詞-格助詞-一般(27,28,1)       デ      デ
は      (は)    助詞-係助詞(28,29,1)    ハ      ワ
、      (、)    記号-読点(29,30,1)      、      、
うまく  (うまい)        形容詞-自立(30,33,3)    ウマク  ウマク
色      (色)    名詞-一般(33,34,1)      {イロ/ショク}   {イロ/ショク}
が      (が)    助詞-格助詞-一般(34,35,1)       ガ      ガ
出      (出る)  動詞-自立(35,36,1)      デ      デ
ない    (ない)  助動詞(36,38,2) ナイ    ナイ
ので    (ので)  助詞-接続助詞(38,40,2)  ノデ    ノデ
買い    (買う)  動詞-自立(40,42,2)      カイ    カイ
ませ    (ます)  助動詞(42,44,2) マセ    マセ
ん      (ん)    助動詞(44,45,1) ン      ン
でし    (です)  助動詞(45,47,2) デシ    デシ
た      (た)    助動詞(47,48,1) タ      タ
。      (。)    記号-句点(48,49,1)      。      。
</pre></td></tr></table>
左から、分割した形態素、形態素の基本形、品詞名(文字列中の開始位置、終了位置、形態素の長さ)、読み、発音を示しています。品詞を特定できない形態素の品詞名は、未知語となり、読みと発音はnullとなります。

<h2>プログラミングガイド</h2>
<p>
Senをライブラリとして利用したい場合は、src/java ディレクトリにあるStringTaggerDemo.java
とStreamTaggerDemo.javaを参考にして下さい。
基本的には、XXXTaggerクラスとTokenクラスを利用すればokです。例えば、次のようになります。
</p>

<pre class=source>
String s = <入力文字列> ;
//日本語用のタガー取得
StringTagger tagger = StringTagger.getInstance(Locale.JAPANESE);
// 形態素解析実行。tokenに形態素の情報を取得
Token[] token = tagger.analyze(s);

for(int i = 0; i < token.length; i++){
  // tokenから形態素情報を取得
  ...  
}
</pre>
ストリームから形態素を取得するときは、StreamTaggerクラスを利用します。StreamTaggerの使い方についてはStreamTaggerDemoを参考にしてください。
詳細については、<a href="api/index.html">APIリファレンス</a>を参照して下さい。
特に重要なクラスは、net.java.sen.StringTagger、net.java.sen.StreamTagger、net.java.sen.Tokenの3クラスです。

<br />
<br />
Tokenクラスの使い方は次の通りです。

<table border=1 bgcolor=lightpink>
<tr bgcolor=lightgreen>
<th>メソッド名</th><th>返却値</th>
</tr>

<tr>
<td>toString()</td><td>切り出された単語</td>
</tr>

<tr>
<td>getBasicString()</td><td>基本形の文字列</td>
</tr>

<tr>
<td>getPos()</td><td>品詞情報</td>
</tr>

<tr>
<td>start()</td><td>入力文字列における形態素の始まり位置</td>
</tr>

<tr>
<td>end()</td><td>入力文字列における形態素の終わり位置</td>
</tr>

<tr>
<td>length()</td><td>単語の長さ</td>
</tr>

<tr>
<td>getReading()</td><td>振り仮名</td>
</tr>

<tr>
<td>getPronunciation()</td><td>発音</td>
</tr>

</table>

<p>
なお、辞書で定義されていない単語の品詞は、デフォルトでは、「未知語」に
設定されています。未定義の単語の品詞を変更したい場合は、conf/sen.xmlを
変更して下さい。
</p>

<h2>TODO(順不同)</h2>
<ul>
  <li>ドキュメント、マニュアル類</li>
  <li>ドキュメント、マニュアル類</li>
  <li>リファクタリング、コードのクリーンアップ(かなり実装はいい加減)</li>
  <li>設定ファイルのバリデーション</li>
</li>
<!--
  <li>文字の正規化処理(やらない)
  <ul>
    <li>カタカナ or 平仮名 + 濁点 -> 濁点付きカタカナ、平仮名</li>
  </ul></li>
-->
</ul>

<h2>その他</h2>
<ul>
  <li>長健太さんによる<a href="http://www.asahi-net.or.jp/~cs8k-cyu/chmap/index.html">Chmap(2ch各板不徹底図解)</a>でご利用頂いております。</li>
  <li>辞書作成の Ant 用の build ファイルのオリジナルは、鰈崎義之さんが作成しました。</li>
  <li>Sen のもととなった、ChaSenTNG は、<a href='http://cl.aist-nara.ac.jp/~taku-ku/'>工藤拓</a>さんが作成しました。</li>
  <li>名前の由来は、ChaSen 程大げさなものを目指していないので、Cha を取って Sen と名付けました。その他に深い意味はありません。</li>
  <li>Sen は、辞書へのアクセス時に、 JDK1.4 を利用しているときは MappedByteBuffer を用い、
      JDK1.3以前のバージョンを利用しているときには、メモリ上に辞書を読む込むようになっています。
      JDK1.3以前のバージョンをお使いの場合で、辞書をメモリ上に読み込みたくない場合は、JVM の引数で、-Dnet.java.sen.io.FileAccessor=net.java.sen.io.RandomAccessReader を指定して下さい。
      処理速度は遅くなりますが、消費メモリは減ります。
    <li>このソフトウェアは、Apache Software Foundationによって開発されたCommons Loggingを含んでいます。
        (This product includes software developed by the Apache Software Foundation (http://www.apache.org/).)
    </ul>
    </li>
    </li>
</ul>

<h2>変更点</h2>
<h4>1.0</h4>
<ul>
<li>ドキュメント整備</li>
</ul>
<h4>1.0RC2</h4>
<ul>
<li>未知語のコストが不正なバグを修正(reported by フクイさん)</li>
<li>辞書作成時のバグ修正&高速化(reported by フクイさん)</li>
</ul>
<h4>1.0RC1</h4>
主な変更点は最新のmecab0.77のコードへのシンクロ&バグフィクス。
<ul>
<li>mecab最新版(0.77)に合わせ、ConnectCost.javaを削除し、コスト計算の機能をTokenizerに移行。</li>
<li>ipadic2tng.plをmecab0.77のipa2mecab.plに入れ換え。</li>
<li>デフォルトの辞書をipadicのバージョン2.5.0から2.6.0に変更。</li>
<li>mecab最新版に合わせ、ConnectCost.javaを削除し、コスト計算の機能をTokenizerに移行。</li>
<li>リファクタリング</li>
<li>接続コストの辞書(matrix.cha)をcloseするようにした</li>
<li>ChaSenと辞書の互換性がないことから辞書の拡張子を.chaから.senに変更。</li>
<li>まれに、DoubleArrayTrie.javaで例外が発生する問題に暫定対処した
(辞書ツールを入れ換えてからは事象が発生していないので、辞書ツールの不具合かも)</li>
</ul>
<h4>0.8(β1)</h4>
<ul>
<li>実際に採用事例が増えて来て、そこそこ実績が出て来たのでβリリースとした</li>
<li>SenTokenizerをsenからlucene-jaに移しLuceneのコードを全て取り除いた</li>
<li>パッケージ名をorg.debian.senからnet.java.senに変更した</li>
<li>コスト計算のバグを修正した(thanx 原田昌紀さん)</li>
<li>castorを不要にした</li>
<li>senの設定ファイルsen.xmlに辞書の場所を相対パスで記述した場合、JavaVMを起動した
    ディレクトリからの相対パスになっていた所をsen.homeプロパティからの相対パスにした。
    これにより、一度sen.xmlを設定すれば任意のディレクトリで実行しても同じ動作が期待できる。</li>
</ul>

<h4>0.44</h4>
<ul>
<li>添付のLuceneを1.3にバージョンアップ</li>
<li>ライセンスをGPLからLGPLへ変更</li>
</ul>

<h4>0.43</h4>
<ul>
  <li>辞書が正しく生成されておらず、形態素解析実行中にExceptionが発生しプログラムが途中で停止するバグを修正。</li>
</ul>
<h4>0.42</h4>
<ul>
  <li>漢字、平仮名、カタカナ、英数字以外の文字が入力されたときに正しく動作しないことがあるバグを修正(JapaneseTokenizer.javaにおけるOTHERの取扱を変更)</li>
</ul>
  <li>Tokenクラスに読みを取得するgetReadingと発音を取得するgetPronunciationメソッドを追加</li>
  <li>平仮名、漢字の未知語が一文字づつ切り出されていたのを、ブロックで抽出するように変更(「ざざざ」→「ざ」×3の形態素として切り出されていたのを「ざざざ」とh一つの形態素で切り出されるようになる)。</li>
<h4>0.41</h4>
<ul>
  <li>HALF_WIDTH クラスの文字が正しく処理できない問題を修正</li>
  <li>StreamTaggerDemoをファイルから読み込んだテキストに対し、文字コードを指定して利用するように変更</li>
</ul>
<h4>0.40</h4>
<ul>
  <li>luceneのJSPのデモで日本語で検索できなバグを修正</li>
  <li>luceneのデモで不正な文字コードを含む文書のインデックスを作成しよ
  うとしたときに、強制終了していたが、続行するように変更</li>
  <li>MorphologicalAnalyzerを廃止し、StringTaggerとStreamTaggerを用意
  </li>
  <li>内部的に大幅に変更。TokenizerとStringTaggerを変更すれば、他の言
  語に対応可能に。</li>
  <li>StringTaggerで、各言語毎にSingletonにできるように変更。</li>
  <li>その他、コードのクリーンアップ等</li>
</ul>
<hr>
<script src='/~tora/footer.js'></script>
</body></html>

